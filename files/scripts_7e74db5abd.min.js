$(document).ready(function () {
    $(".franchise-doings-slider").slick({
        mobileFirst:true,
        dots: true,
        centerMode: true,
        infinite: true,
        slidesToShow: 4,
        slidesToScroll: 1,
        speed: 200,
        variableWidth: true,
        prevArrow: '<i class="slick-prev fa" aria-hidden="true"></i>',
        nextArrow: '<i class="slick-next fa" aria-hidden="true"></i>',
        responsive: [
            {
                breakpoint: 1024,
                settings: {
                    dots: false,
                    centerMode: false,
                    slidesToShow: 4,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 480,
                settings: {
                    dots: true,
                    centerMode: true,
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
        ]
    });
    if (window.matchMedia("(max-width: 768px)").matches) {
        $(".slick-mob").slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            speed: 200,
            prevArrow: '<i class="slick-prev fa" aria-hidden="true"></i>',
            nextArrow: '<i class="slick-next fa" aria-hidden="true"></i>'
        });
        $(".slick-mob-diff").slick({
            dots: true,
            centerMode: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            speed: 200,
            prevArrow: '<i class="slick-prev fa" aria-hidden="true"></i>',
            nextArrow: '<i class="slick-next fa" aria-hidden="true"></i>'
        });
    }
    $(".section.section-header .select ").on("click", ".btn", function (event) {
        event.preventDefault();
        var id = '.section-bookit',
            top = $(id).offset().top;
        $('body,html').animate({scrollTop: top}, 1500);
    });
    $(".section").on("click", ".link-inline", function (event) {
        event.preventDefault();
        var id = '.section-bookit',
            top = $(id).offset().top;
        $('body,html').animate({scrollTop: top}, 1500);
    });
    $(document).on('submit', 'form', function (e) {
        e.preventDefault();
        form = $(this);

        $.ajax({
            url: 'ajax.php',
            data: form.serialize(),
            type: "post",
            dataType: "json",
            success: function (resp) {
                $(form).find('input', 'button').remove();
                if (resp.transaction_id) {
                    ga('require', 'ecommerce');
                    ga('ecommerce:addTransaction', {
                        'id': resp.transaction_id,
                        'affiliation': 'Franchises Orders',
                        'revenue': resp.franchise_invest,
                        'shipping': '0',
                        'tax': '0'
                    });
                    ga('ecommerce:addItem', {
                        'id': resp.transaction_id,
                        'name': resp.franchise_name,
                        'sku': resp.order_article,
                        'category': resp.order_id,
                        'price': resp.franchise_invest,
                        'quantity': '1'

                    });
                    ga('ecommerce:send');
                }
                $('.section.section-bookit h2').html('Спасибо! Ваша заявка успешно отправлена!');
                form.remove();
            }
        });
    });
});

(function () {
    let moreButton = document.querySelector(".section-videos .show-more a.btn");
    moreButton.addEventListener("click", function(e){
        e.preventDefault();
        let vids = document.querySelector('.section-videos #videos-hidden')
        let vidsMobile = document.querySelector('.section-videos #videos-hidden-mob');
        if ($(window).width() < 767) {
            vidsMobile.classList.toggle('hide-me');
        }
        vids.classList.toggle('hide-me');
        this.textContent = (this.textContent == 'Показать еще') ? 'Скрыть' : 'Показать еще'
    })

    let moreButtonSlider = document.querySelector(".section-slider .show-more a.btn");
    moreButtonSlider.addEventListener("click", function(e){
        e.preventDefault();
        let slider = document.querySelector('.section-slider .slider-hidden')
        slider.classList.toggle('hide-me');
        this.textContent = (this.textContent == 'Ещё') ? 'Скрыть' : 'Ещё'
    })
})();

if (screen.width < 768) {
    var panZoom = svgPanZoom('#svg', {
        zoomEnabled: false,
        zoomScaleSensitivity: 0.5,
        controlIconsEnabled: false,
        dblClickZoomEnabled: false,
        center: true,
        fit: true,
        minZoom: 0.1,
        beforePan: function() {
            $('#services-map .service').popover('hide');
        }
    });
}
